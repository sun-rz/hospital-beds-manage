<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="graduation.project.hospitalbedsmanage.mapper.BigDataMapper">
    <select id="getHospitalCount" resultType="HashMap">
        select count(1) as mzTotal from patient
        union all
        select count(1) as mzMonth from patient left join casehistory on casehistory.patientID=patient.id
        where DATE_FORMAT(DATE_SUB(casehistory.submitTime, INTERVAL 0 MONTH),'%Y-%m')=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 0 MONTH),'%Y-%m')
        union all
        select count(1) as zyTotal from patient where bedNo is not null
        union all
        select count(1) as zyMonth from patient left join casehistory on casehistory.patientID=patient.id
        where DATE_FORMAT(DATE_SUB(casehistory.submitTime, INTERVAL 0 MONTH),'%Y-%m')=DATE_FORMAT(DATE_SUB(CURDATE(), INTERVAL 0 MONTH),'%Y-%m') and bedNo is not null
    </select>
</mapper>
